(function(){const a=document.createElement("link").relList;if(a&&a.supports&&a.supports("modulepreload"))return;for(const e of document.querySelectorAll('link[rel="modulepreload"]'))i(e);new MutationObserver(e=>{for(const t of e)if(t.type==="childList")for(const s of t.addedNodes)s.tagName==="LINK"&&s.rel==="modulepreload"&&i(s)}).observe(document,{childList:!0,subtree:!0});function r(e){const t={};return e.integrity&&(t.integrity=e.integrity),e.referrerPolicy&&(t.referrerPolicy=e.referrerPolicy),e.crossOrigin==="use-credentials"?t.credentials="include":e.crossOrigin==="anonymous"?t.credentials="omit":t.credentials="same-origin",t}function i(e){if(e.ep)return;e.ep=!0;const t=r(e);fetch(e.href,t)}})();window.screen.orientation.lock("landscape");const l=document.getElementById("delayed-video"),I=l.getContext("2d",{alpha:!1,depth:!1,antialias:!1}),o=document.getElementById("webcam");window.onresize=v;l.ondblclick=()=>{document.fullscreenElement?document.exitFullscreen():document.body.requestFullscreen()};C();function C(){navigator.mediaDevices.getUserMedia({audio:!1,video:{facingMode:"user",width:{ideal:window.screen.width},height:{ideal:window.screen.height},resizeMode:{exact:"none"}}}).then(function(n){console.log(n.getVideoTracks()[0].getSettings());const a=n.getVideoTracks()[0].getSettings();o.srcObject=n;let r=a.width,i=a.height;l.width=r,l.height=i,o.width=.2*r,o.height=.2*i;const t=new OffscreenCanvas(r,i).getContext("2d",{willReadFrequently:!0,alpha:!1,depth:!1,antialias:!1}),s=document.getElementById("data");let d=2e3;const f=document.getElementById("delay-in-ms");f.value=d.toString(),f.onchange=()=>d=f.valueAsNumber,o.addEventListener("loadedmetadata",function(b){console.log(b),r=o.videoWidth,i=o.videoHeight,v();const g=1e3/a.frameRate,c=[];let E=Date.now();function m(){const u=Date.now(),x=u-E;t.drawImage(o,0,0,r,i),x*2>=g&&c.push({time:u,image:t.getImageData(0,0,r,i)});const h=2*g;if(c.length>0){let p=!0;for(;p;)u-c[0].time-h>=d?c.shift():p=!1;const y=c[0];I.putImageData(y.image,0,0);const w=u-y.time;w+h<=d?s.innerText=`buffering: ${w}ms`:s.innerText=""}requestAnimationFrame(m)}m()})}).catch(function(n){console.error("Error accessing webcam:",n)})}function v(){const n=l.getBoundingClientRect();o.style.width=`${.2*n.width}px`,o.style.height=`${.2*n.height}px`}
