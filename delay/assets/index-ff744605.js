(function(){const o=document.createElement("link").relList;if(o&&o.supports&&o.supports("modulepreload"))return;for(const e of document.querySelectorAll('link[rel="modulepreload"]'))n(e);new MutationObserver(e=>{for(const t of e)if(t.type==="childList")for(const c of t.addedNodes)c.tagName==="LINK"&&c.rel==="modulepreload"&&n(c)}).observe(document,{childList:!0,subtree:!0});function i(e){const t={};return e.integrity&&(t.integrity=e.integrity),e.referrerPolicy&&(t.referrerPolicy=e.referrerPolicy),e.crossOrigin==="use-credentials"?t.credentials="include":e.crossOrigin==="anonymous"?t.credentials="omit":t.credentials="same-origin",t}function n(e){if(e.ep)return;e.ep=!0;const t=i(e);fetch(e.href,t)}})();const a=document.getElementById("delayed-video"),C=a.getContext("2d",{alpha:!1,depth:!1,antialias:!1}),w=document.getElementById("backgrounded-container"),r=document.getElementById("webcam");window.onresize=v;a.ondblclick=()=>{document.fullscreenElement?document.exitFullscreen():document.body.requestFullscreen()};F();function F(){navigator.mediaDevices.getUserMedia({audio:!1,video:{facingMode:"user",width:{ideal:window.screen.width},height:{ideal:window.screen.height},resizeMode:{exact:"none"}}}).then(function(s){console.log(s.getVideoTracks()[0].getSettings());const o=s.getVideoTracks()[0].getSettings();r.srcObject=s;let i=o.width,n=o.height;a.width=i,a.height=n,v(),r.width=.2*i,r.height=.2*n;const t=new OffscreenCanvas(i,n).getContext("2d",{willReadFrequently:!0,alpha:!1,depth:!1,antialias:!1}),c=document.getElementById("data");let d=2e3;const f=document.getElementById("delay-in-ms");f.value=d.toString(),f.onchange=()=>d=f.valueAsNumber,r.addEventListener("loadedmetadata",function(b){console.log(b),i=r.videoWidth,n=r.videoHeight;const g=1e3/o.frameRate,l=[];let E=Date.now();function m(){const u=Date.now(),x=u-E;t.drawImage(r,0,0,i,n),x*2>=g&&l.push({time:u,image:t.getImageData(0,0,i,n)});const I=2*g;if(l.length>0){let h=!0;for(;h;)u-l[0].time-I>=d?l.shift():h=!1;const p=l[0];C.putImageData(p.image,0,0);const y=u-p.time;y<=d?c.innerText=`buffering: ${y.toString().padStart(5)}ms`:c.innerText=""}requestAnimationFrame(m)}m()})}).catch(function(s){console.error("Error accessing webcam:",s)})}function v(){const s=window.innerWidth/a.width,o=window.innerHeight/a.height,i=Math.min(s,o);w.style.transformOrigin="center 0px",w.style.transform=`scale(-${i}, ${i})`;const n=a.getBoundingClientRect();r.style.width=`${.2*n.width}px`,r.style.height=`${.2*n.height}px`}
